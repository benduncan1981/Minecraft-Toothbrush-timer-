<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Minecraft Brush Adventure</title>
<style>
body {
  margin:0;
  overflow:hidden;
  font-family:Arial, sans-serif;
  background:black;
}
#ui {
  position:absolute;
  top:10px;
  left:10px;
  color:white;
  z-index:10;
  font-size:18px;
  text-shadow:2px 2px 4px black;
}
button {
  font-size:16px;
  margin-top:5px;
}
#reward {
  position:absolute;
  bottom:20px;
  width:100%;
  text-align:center;
  font-size:28px;
  color:gold;
  text-shadow:3px 3px 6px black;
}
</style>
</head>
<body>
<div id="ui">
  <div id="timer"></div>
  <div id="biome"></div>
  <div id="streak"></div>
  <div id="totalDays"></div>
  <button onclick="startBrush()">Start Brushing</button>
  <button onclick="manualBrush()">Add Manual Brush</button>
</div>
<div id="reward"></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let brushing = false;
let startTime = 0;
let biomeIndex = 0;
let dragonAngle = 0;
let arrows = [];
let rewardMessage = "";

const biomes = ["Overworld","Nether","The End"];

function getToday() {
  return new Date().toISOString().split("T")[0];
}

function loadData() {
  return {
    streak: parseInt(localStorage.getItem("streak")||0),
    total: parseInt(localStorage.getItem("totalDays")||0),
    last: localStorage.getItem("lastDate")||""
  };
}

function saveData(data) {
  localStorage.setItem("streak",data.streak);
  localStorage.setItem("totalDays",data.total);
  localStorage.setItem("lastDate",data.last);
}

function updateDisplay() {
  let data = loadData();
  document.getElementById("streak").innerText = "Streak: "+data.streak+" days";
  document.getElementById("totalDays").innerText = "Total days brushed: "+data.total;
}

function rewardCheck(streak) {
  if (streak % 7 === 0) {
    rewardMessage = "Weekly Reward Unlocked!";
  }
}

function registerBrush() {
  let data = loadData();
  let today = getToday();
  if (data.last !== today) {
    let yesterday = new Date();
    yesterday.setDate(yesterday.getDate()-1);
    let yDate = yesterday.toISOString().split("T")[0];

    if (data.last === yDate) data.streak++;
    else data.streak = 1;

    data.total++;
    data.last = today;
    rewardCheck(data.streak);
    saveData(data);
    updateDisplay();
  }
}

function manualBrush() {
  registerBrush();
}

function startBrush() {
  brushing = true;
  startTime = Date.now();
  biomeIndex = 0;
  rewardMessage = "";
  arrows = [];
}

function drawBlock(x,y,size,color) {
  ctx.fillStyle = color;
  ctx.fillRect(x,y,size,size);
  ctx.strokeStyle="rgba(0,0,0,0.2)";
  ctx.strokeRect(x,y,size,size);
}

function drawOverworld() {
  for(let i=0;i<canvas.width;i+=40){
    drawBlock(i,canvas.height-200,40,"#3cb043");
    drawBlock(i,canvas.height-160,40,"#7cfc00");
  }

  ctx.fillStyle="yellow";
  ctx.beginPath();
  ctx.arc(canvas.width-100,100,50,0,Math.PI*2);
  ctx.fill();

  for(let i=0;i<5;i++){
    drawBlock(100+i*120,canvas.height-240,40,"#8b5a2b");
    drawBlock(60+i*120,canvas.height-280,120,"#228b22");
  }

  ctx.fillStyle="white";
  ctx.fillRect(200,100,120,40);
  ctx.fillRect(500,140,150,40);

  ctx.fillStyle="pink";
  drawBlock(300,canvas.height-180,30,"pink");
}

function drawNether() {
  ctx.fillStyle="#330000";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<canvas.width;i+=40){
    drawBlock(i,canvas.height-200,40,"#8b0000");
  }
}

function drawEnd() {
  ctx.fillStyle="#111122";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<canvas.width;i+=40){
    drawBlock(i,canvas.height-200,40,"#444");
  }

  dragonAngle+=0.03;
  let dx = canvas.width/2 + Math.cos(dragonAngle)*200;
  let dy = 200 + Math.sin(dragonAngle)*50;

  ctx.fillStyle="purple";
  ctx.fillRect(dx,dy,120,40);
  ctx.fillRect(dx+40,dy-30,40,30);

  if (Math.random()<0.1) {
    arrows.push({x:canvas.width/2,y:canvas.height-200});
  }

  arrows.forEach(a=>{
    a.y-=6;
    ctx.fillStyle="white";
    ctx.fillRect(a.x,a.y,4,20);
  });
}

function animate() {
  requestAnimationFrame(animate);

  ctx.clearRect(0,0,canvas.width,canvas.height);

  if (!brushing) return;

  let elapsed = (Date.now()-startTime)/1000;
  let timeLeft = Math.max(0,90-elapsed);
  document.getElementById("timer").innerText = "Time: "+timeLeft.toFixed(0);

  biomeIndex = Math.floor(elapsed/30);
  if (biomeIndex>2) biomeIndex=2;
  document.getElementById("biome").innerText = "Biome: "+biomes[biomeIndex];

  if (biomeIndex===0) drawOverworld();
  if (biomeIndex===1) drawNether();
  if (biomeIndex===2) drawEnd();

  if (elapsed>=90) {
    brushing=false;
    registerBrush();
    document.getElementById("reward").innerText=rewardMessage;
  }
}

updateDisplay();
animate();
</script>
</body>
</html>
